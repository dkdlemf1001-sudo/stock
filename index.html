<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>íˆ¬ì Supporter</title>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;700&display=swap" rel="stylesheet">
    <style>
        :root { --primary: #1e3799; --accent: #fa983a; --bg: #f1f2f6; --card: #ffffff; --pos: #eb4d4b; --neg: #0984e3; }
        body { font-family: 'Noto Sans KR', sans-serif; background: var(--bg); margin: 0; padding: 0; touch-action: manipulation; }
        header { background: var(--primary); color: white; padding: 40px 20px; text-align: center; }
        .container { max-width: 1000px; margin: -30px auto 50px; padding: 0 15px; }
        
        /* íƒ­ í´ë¦­ ì˜ì—­ ë””ë²„ê¹…: ë†’ì´ì™€ ê°„ê²© ì¡°ì • */
        .tabs { display: flex; gap: 8px; margin-bottom: 0; position: relative; z-index: 10; }
        .tab { flex: 1; padding: 18px 10px; border: none; border-radius: 12px 12px 0 0; cursor: pointer; font-weight: bold; background: #ced6e0; color: #2f3542; font-size: 16px; transition: all 0.2s; }
        .tab.active { background: var(--card); color: var(--primary); border-top: 5px solid var(--accent); }

        .content { background: var(--card); padding: 25px 15px; border-radius: 0 0 15px 15px; box-shadow: 0 10px 20px rgba(0,0,0,0.05); display: none; }
        .content.active { display: block; border-top: 1px solid #eee; }

        /* í…Œì´ë¸” ìŠ¤í¬ë¡¤ ë¬¸ì œ í•´ê²° (ëª¨ë°”ì¼ ë””ë²„ê¹…) */
        .table-wrapper { overflow-x: auto; -webkit-overflow-scrolling: touch; }
        table { width: 100%; border-collapse: collapse; min-width: 500px; }
        th { text-align: left; color: #747d8c; border-bottom: 2px solid #f1f2f6; padding: 12px 8px; font-size: 14px; }
        td { padding: 12px 8px; border-bottom: 1px solid #f8f9fa; }
        
        /* ì…ë ¥ì°½ í„°ì¹˜ ê°ë„ í–¥ìƒ */
        input { width: 90%; padding: 10px 5px; border: 1px solid #ddd; border-radius: 6px; font-size: 15px; -webkit-appearance: none; }
        input:focus { border-color: var(--accent); outline: none; box-shadow: 0 0 5px rgba(250, 152, 58, 0.3); }

        .btn { padding: 12px 20px; border-radius: 8px; border: none; cursor: pointer; font-weight: bold; display: inline-block; font-size: 15px; }
        .btn-add { background: var(--primary); color: white; margin-bottom: 15px; width: 100%; }
        .btn-save { background: var(--accent); color: white; width: 100%; font-size: 17px; margin-top: 25px; box-shadow: 0 4px 10px rgba(250, 152, 58, 0.3); }
        .btn-del { background: #ff7675; color: white; padding: 8px 12px; }

        .stock-card { border: 1px solid #dfe6e9; border-radius: 12px; padding: 20px; margin-bottom: 15px; background: #fff; }
        .buffett-box { background: #fdfaf0; border-left: 4px solid var(--accent); padding: 15px; margin-top: 15px; font-style: italic; }
    </style>
</head>
<body>

<header>
    <h1>íˆ¬ì Supporter</h1>
    <p>ì›Œë Œ ë²„í•ì˜ í˜œì•ˆì„ ë‹´ì€ ê´€ë¦¬ ë„êµ¬</p>
</header>

<div class="container">
    <div class="tabs">
        <button id="t-btn0" class="tab active" onclick="openT(0)">ë‚´ í¬íŠ¸í´ë¦¬ì˜¤</button>
        <button id="t-btn1" class="tab" onclick="openT(1)">ì£¼ëª©í• ë§Œí•œ ì£¼ì‹</button>
    </div>

    <div id="c0" class="content active">
        <button class="btn btn-add" onclick="addRow()">+ ìƒˆ ì¢…ëª© ì¶”ê°€</button>
        <div class="table-wrapper">
            <table>
                <thead><tr><th>ì¢…ëª©ëª…</th><th>ìˆ˜ëŸ‰</th><th>ë§¤ìˆ˜ê°€</th><th>í˜„ì¬ê°€</th><th>ìˆ˜ìµë¥ </th><th>ê´€ë¦¬</th></tr></thead>
                <tbody id="list"></tbody>
            </table>
        </div>
        <button class="btn btn-save" onclick="save()">ğŸ’¾ ë¸Œë¼ìš°ì €ì— ë°ì´í„° ì €ì¥</button>
    </div>

    <div id="c1" class="content">
        <div class="stock-card">
            <span style="color:var(--accent); font-weight:bold;">#ì•ˆì „ë§ˆì§„</span>
            <h3>Apple (AAPL)</h3>
            <p><strong>íˆ¬ì í¬ì¸íŠ¸:</strong> ì••ë„ì ì¸ ë¸Œëœë“œ ê²½ìŸë ¥ê³¼ í˜„ê¸ˆ ì°½ì¶œ ëŠ¥ë ¥.</p>
            <div class="buffett-box">"ìš°ë¦¬ëŠ” í›Œë¥­í•œ ê¸°ì—…ì„ í›Œë¥­í•œ ê°€ê²©ì— ì‚¬ëŠ” ê²ƒì„ ì„ í˜¸í•©ë‹ˆë‹¤."</div>
        </div>
        <div class="stock-card">
            <span style="color:var(--accent); font-weight:bold;">#ë¬´í•œìˆ˜ìš”</span>
            <h3>Coca-Cola (KO)</h3>
            <p><strong>íˆ¬ì í¬ì¸íŠ¸:</strong> ì¸í”Œë ˆì´ì…˜ ìƒí™©ì—ì„œë„ ê°€ê²© ê²°ì •ë ¥ì„ ê°€ì§„ ë¹„ì¦ˆë‹ˆìŠ¤.</p>
            <div class="buffett-box">"ì£¼ì‹ ì‹œì¥ì€ ì¸ë‚´ì‹¬ ì—†ëŠ” ì‚¬ëŒì˜ ëˆì„ ì¸ë‚´ì‹¬ ìˆëŠ” ì‚¬ëŒì—ê²Œ ì „ë‹¬í•˜ëŠ” ë„êµ¬ì…ë‹ˆë‹¤."</div>
        </div>
    </div>
</div>

<script>
    // íƒ­ ì „í™˜ ë””ë²„ê¹…: ì´ë²¤íŠ¸ ì „íŒŒ ë°©ì§€ ë° ìƒíƒœ í™•ì‹¤íˆ ë³€ê²½
    function openT(i) {
        document.querySelectorAll('.content').forEach((c, idx) => c.classList.toggle('active', i === idx));
        document.querySelectorAll('.tab').forEach((t, idx) => t.classList.toggle('active', i === idx));
    }

    // í–‰ ì¶”ê°€ ë””ë²„ê¹…: ë°ì´í„° ìœ íš¨ì„± ê²€ì‚¬ ì¶”ê°€
    function addRow(d = {}) {
        const tr = document.createElement('tr');
        tr.innerHTML = `
            <td><input type="text" value="${d.n || ''}" class="n" placeholder="ì¢…ëª©ëª…"></td>
            <td><input type="number" value="${d.q || ''}" class="q" placeholder="0" oninput="calc()"></td>
            <td><input type="number" value="${d.b || ''}" class="b" placeholder="0" oninput="calc()"></td>
            <td><input type="number" value="${d.c || ''}" class="c" placeholder="0" oninput="calc()"></td>
            <td class="r" style="font-weight:bold">0%</td>
            <td><button class="btn btn-del" onclick="this.closest('tr').remove(); calc();">ì‚­ì œ</button></td>
        `;
        document.getElementById('list').appendChild(tr);
        calc();
    }

    // ê³„ì‚° ë¡œì§ ë””ë²„ê¹…: ìˆ«ìê°€ ì•„ë‹Œ ê°’ ì²˜ë¦¬(NaN ì˜ˆë°©)
    function calc() {
        document.querySelectorAll('#list tr').forEach(row => {
            const q = parseFloat(row.querySelector('.q').value) || 0;
            const b = parseFloat(row.querySelector('.b').value) || 0;
            const c = parseFloat(row.querySelector('.c').value) || 0;
            
            let r = 0;
            if (b > 0) {
                r = ((c - b) / b * 100).toFixed(2);
            }
            
            const rCell = row.querySelector('.r');
            rCell.innerText = r + "%";
            rCell.style.color = r > 0 ? '#eb4d4b' : (r < 0 ? '#0984e3' : '#333');
        });
    }

    // ì €ì¥ ë¡œì§ ë””ë²„ê¹…
    function save() {
        const rows = document.querySelectorAll('#list tr');
        const data = Array.from(rows).map(row => ({
            n: row.querySelector('.n').value,
            q: row.querySelector('.q').value,
            b: row.querySelector('.b').value,
            c: row.querySelector('.c').value
        }));
        
        if(data.length === 0) {
            alert("ì €ì¥í•  ì¢…ëª©ì´ ì—†ìŠµë‹ˆë‹¤.");
            return;
        }
        
        localStorage.setItem('myStocks_v2', JSON.stringify(data));
        alert('ì„±ê³µì ìœ¼ë¡œ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤! ì´ì œ ì°½ì„ ë‹«ì•„ë„ ë°ì´í„°ê°€ ìœ ì§€ë©ë‹ˆë‹¤.');
    }

    // ì´ˆê¸° ë¡œë“œ ë””ë²„ê¹…
    window.onload = () => {
        const saved = JSON.parse(localStorage.getItem('myStocks_v2') || '[]');
        if (saved.length > 0) {
            saved.forEach(addRow);
        } else {
            addRow(); // ë°ì´í„° ì—†ìœ¼ë©´ ë¹ˆ ì¤„ í•˜ë‚˜ ìƒì„±
        }
    };
</script>
</body>
</html>
